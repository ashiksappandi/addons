<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <script type="text/javascript" src="jquery.js"></script>


  <style type="text/css">
.statuses li {
  color: red;
}

li.operational, li.good {
  color: green;
}
.bad {
  color: red;
}
td {
  vertical-align: top;
}
h1 {
  font-size: 120%;
}
  </style>

  <title>Statusbot</title>

<script type='text/javascript'>
$(function() {
  var services = decodeURI(location.search).substring(1).split("&");
  if (services.length == 1 && services[0].length == 0) { services = ["twilio", "tropo", "mailgun"] };
  for (i = 0; i < services.length; i++) {
    loadStatus(services[i]);
  }
});

function loadStatus(tool) {
  $.get("https://api.statusbot.io/v1/services/" + tool + "/components", function(d) {
    console.log(d);
    var bad = false;
    var s = "<td><h1 id='" + d.service.name + "'>" + d.service.human_readable_name + "</h1><ul class='statuses'>";
    for (i = 0; i < d.service.components.length; i++) {
      s += "<li class='" + d.service.components[i].status_indicator + "'>" + (d.service.components[i].name || d.service.components[i].description) + ": " + d.service.components[i].status_indicator + "</li>";
      if (d.service.components[i].status_indicator != "good") { bad = true };
    }
    s += "</ul></td>";
    $(".result").append(s);
    if (bad) { $("#" + d.service.name).addClass("bad") };
  });
}


</script>

</head>

<body>
  <table>
    <tr class="result">
  </tr>
  </table>
</body>
</html>
